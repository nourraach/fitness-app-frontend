<div class="notifications-container">
  <div class="header">
    <h2>üîî Mes Notifications</h2>
    <button class="btn-preferences" (click)="togglePreferences()">
      ‚öôÔ∏è Pr√©f√©rences
    </button>
  </div>

  <div *ngIf="message" [class]="'alert alert-' + messageType">{{ message }}</div>

  <!-- Section Pr√©f√©rences -->
  <div *ngIf="afficherPreferences" class="preferences-section">
    <div class="preferences-card">
      <h3>Param√®tres des Notifications</h3>
      
      <div class="preference-group">
        <div class="preference-header">
          <label class="switch">
            <input type="checkbox" [(ngModel)]="preferences.notificationsActives">
            <span class="slider"></span>
          </label>
          <span class="preference-title">Activer les notifications</span>
        </div>
      </div>

      <div class="preferences-grid" *ngIf="preferences.notificationsActives">
        <!-- Petit d√©jeuner -->
        <div class="preference-item">
          <div class="preference-header">
            <label class="switch">
              <input type="checkbox" [(ngModel)]="preferences.rappelPetitDejeuner">
              <span class="slider"></span>
            </label>
            <span class="preference-label">üç≥ Petit d√©jeuner</span>
          </div>
          <input *ngIf="preferences.rappelPetitDejeuner" 
                 type="time" 
                 [(ngModel)]="preferences.heurePetitDejeuner" 
                 class="time-input">
        </div>

        <!-- D√©jeuner -->
        <div class="preference-item">
          <div class="preference-header">
            <label class="switch">
              <input type="checkbox" [(ngModel)]="preferences.rappelDejeuner">
              <span class="slider"></span>
            </label>
            <span class="preference-label">üçΩÔ∏è D√©jeuner</span>
          </div>
          <input *ngIf="preferences.rappelDejeuner" 
                 type="time" 
                 [(ngModel)]="preferences.heureDejeuner" 
                 class="time-input">
        </div>

        <!-- D√Æner -->
        <div class="preference-item">
          <div class="preference-header">
            <label class="switch">
              <input type="checkbox" [(ngModel)]="preferences.rappelDiner">
              <span class="slider"></span>
            </label>
            <span class="preference-label">üåô D√Æner</span>
          </div>
          <input *ngIf="preferences.rappelDiner" 
                 type="time" 
                 [(ngModel)]="preferences.heureDiner" 
                 class="time-input">
        </div>

        <!-- Collation -->
        <div class="preference-item">
          <div class="preference-header">
            <label class="switch">
              <input type="checkbox" [(ngModel)]="preferences.rappelCollation">
              <span class="slider"></span>
            </label>
            <span class="preference-label">üçé Collation</span>
          </div>
          <input *ngIf="preferences.rappelCollation" 
                 type="time" 
                 [(ngModel)]="preferences.heureCollation" 
                 class="time-input">
        </div>

        <!-- Motivation -->
        <div class="preference-item">
          <div class="preference-header">
            <label class="switch">
              <input type="checkbox" [(ngModel)]="preferences.motivationQuotidienne">
              <span class="slider"></span>
            </label>
            <span class="preference-label">üí™ Message de motivation</span>
          </div>
          <input *ngIf="preferences.motivationQuotidienne" 
                 type="time" 
                 [(ngModel)]="preferences.heureMotivation" 
                 class="time-input">
        </div>

        <!-- Activit√© -->
        <div class="preference-item">
          <div class="preference-header">
            <label class="switch">
              <input type="checkbox" [(ngModel)]="preferences.rappelActivite">
              <span class="slider"></span>
            </label>
            <span class="preference-label">üèÉ Activit√© physique</span>
          </div>
          <input *ngIf="preferences.rappelActivite" 
                 type="time" 
                 [(ngModel)]="preferences.heureActivite" 
                 class="time-input">
        </div>
      </div>

      <div class="preferences-actions">
        <button class="btn-secondary" (click)="togglePreferences()">Annuler</button>
        <button class="btn-primary" (click)="sauvegarderPreferences()">Enregistrer</button>
      </div>
    </div>
  </div>

  <!-- Section Notifications -->
  <div class="notifications-section">
    <div class="notifications-header">
      <div class="toggle-buttons">
        <button [class.active]="!afficherToutesNotifications" (click)="toggleAffichage()">
          Non lues ({{ notificationsNonLues.length }})
        </button>
        <button [class.active]="afficherToutesNotifications" (click)="toggleAffichage()">
          Toutes
        </button>
      </div>
      <button *ngIf="notificationsNonLues.length > 0" 
              class="btn-mark-all" 
              (click)="marquerToutesCommeLues()">
        ‚úì Tout marquer comme lu
      </button>
    </div>

    <div *ngIf="loading" class="loading-state">
      <p>Chargement des notifications...</p>
    </div>

    <div *ngIf="!loading && getListeNotifications().length > 0" class="notifications-list">
      <div *ngFor="let notification of getListeNotifications()" 
           class="notification-card"
           [class.non-lue]="!notification.estLue"
           [style.border-left-color]="getCouleurType(notification.type)"
           (click)="marquerCommeLue(notification)">
        <div class="notification-icon" [style.color]="getCouleurType(notification.type)">
          {{ getIconeType(notification.type) }}
        </div>
        <div class="notification-content">
          <h4>{{ notification.titre }}</h4>
          <p>{{ notification.message }}</p>
          <span class="notification-date">
            {{ notification.dateProgrammee | date:'dd/MM/yyyy HH:mm' }}
          </span>
        </div>
        <button class="btn-delete-notif" (click)="supprimerNotification(notification.id!); $event.stopPropagation()">
          √ó
        </button>
      </div>
    </div>

    <div *ngIf="!loading && getListeNotifications().length === 0" class="empty-state">
      <div class="empty-icon">üîî</div>
      <p>Aucune notification pour le moment</p>
      <small>Configurez vos pr√©f√©rences pour recevoir des rappels personnalis√©s</small>
    </div>
  </div>
</div>
