<div class="coach-clients-container">
  <!-- Header -->
  <div class="header">
    <div class="header-content">
      <h1>ðŸ‘¥ Mes Clients</h1>
      <p class="subtitle">GÃ©rez vos clients et suivez leurs progrÃ¨s</p>
    </div>
    <button class="btn-primary" (click)="openAssignModal()">
      <i class="pi pi-plus"></i>
      Assigner un client
    </button>
  </div>

  <!-- Messages -->
  <div *ngIf="successMessage" class="alert alert-success">
    âœ“ {{ successMessage }}
  </div>
  <div *ngIf="errorMessage" class="alert alert-error">
    âœ— {{ errorMessage }}
  </div>

  <!-- Search and Filter Bar -->
  <div class="search-filter-bar">
    <div class="search-section">
      <i class="pi pi-search"></i>
      <input 
        type="text" 
        [(ngModel)]="searchTerm" 
        placeholder="Rechercher un client par nom ou email..."
        class="search-input">
    </div>
    
    <div class="filter-section">
      <select [(ngModel)]="sortBy" class="sort-select">
        <option value="name">Trier par nom</option>
        <option value="progressRate">Trier par progrÃ¨s</option>
        <option value="programsCount">Trier par programmes</option>
        <option value="lastActivity">Trier par activitÃ©</option>
      </select>
    </div>
  </div>

  <!-- Clients List -->
  <div *ngIf="loading && myClients.length === 0" class="loading">
    Chargement des clients...
  </div>

  <div *ngIf="!loading && filteredClients.length === 0" class="empty-state">
    <div class="empty-icon">ðŸ‘¥</div>
    <h3>Aucun client trouvÃ©</h3>
    <p *ngIf="searchTerm">Aucun client ne correspond Ã  votre recherche</p>
    <p *ngIf="!searchTerm">Commencez par assigner des clients Ã  votre liste</p>
    <button class="btn-primary" (click)="openAssignModal()" *ngIf="!searchTerm">
      Assigner un client
    </button>
  </div>

  <div class="clients-grid" *ngIf="filteredClients.length > 0">
    <div *ngFor="let client of filteredClients" class="client-card" [class.inactive-client]="client.isInactive">
      <div class="client-header">
        <div class="client-avatar">
          <i class="pi pi-user"></i>
        </div>
        <div class="client-info">
          <h3>{{ client.name }}</h3>
          <p class="client-email">{{ client.email }}</p>
          <div class="status-badges">
            <span class="status-badge" [ngClass]="getStatusClass(client.status)">
              {{ getStatusLabel(client.status) }}
            </span>
            <span *ngIf="client.isInactive" class="inactive-badge">
              <i class="pi pi-exclamation-triangle"></i>
              Inactif
            </span>
          </div>
        </div>
      </div>

      <div class="client-details">
        <div class="detail-item">
          <i class="pi pi-calendar"></i>
          <span>AssignÃ© le {{ client.assignedDate | date:'dd/MM/yyyy' }}</span>
        </div>
        <div class="detail-item">
          <i class="pi pi-clock"></i>
          <span>{{ formatLastActivity(client.lastActivity) }}</span>
        </div>
        <div class="detail-item" *ngIf="client.phone">
          <i class="pi pi-phone"></i>
          <span>{{ client.phone }}</span>
        </div>
      </div>

      <div class="client-stats">
        <div class="stat-item">
          <div class="stat-label">Programmes</div>
          <div class="stat-value">{{ client.programsCount }}</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">ProgrÃ¨s</div>
          <div class="stat-value" [ngClass]="client.progressClass">
            {{ client.progressRate }}%
          </div>
        </div>
      </div>

      <div class="client-actions">
        <button class="btn-view" (click)="viewClientDetails(client)">
          <i class="pi pi-eye"></i>
          Voir dÃ©tails
        </button>
        <button class="btn-remove" (click)="unassignClient(client)">
          <i class="pi pi-times"></i>
          Retirer
        </button>
      </div>
    </div>
  </div>

  <!-- Modal: Assign Client -->
  <div *ngIf="showAssignModal" class="modal-overlay" (click)="closeAssignModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>Assigner un nouveau client</h2>
        <button class="btn-close" (click)="closeAssignModal()">âœ•</button>
      </div>

      <div class="modal-body">
        <div *ngIf="errorMessage" class="alert alert-error">
          {{ errorMessage }}
        </div>

        <div *ngIf="availableClients.length === 0" class="empty-state">
          <p>Aucun client disponible pour le moment</p>
        </div>

        <div class="available-clients-list" *ngIf="availableClients.length > 0">
          <div *ngFor="let client of availableClients" class="available-client-item">
            <div class="client-avatar-small">
              <i class="pi pi-user"></i>
            </div>
            <div class="client-info-small">
              <h4>{{ client.name }}</h4>
              <p>{{ client.email }}</p>
            </div>
            <button class="btn-assign" (click)="assignClient(client)" [disabled]="loading">
              <i class="pi pi-plus"></i>
              Assigner
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal: Client Details -->
  <div *ngIf="selectedClient" class="modal-overlay" (click)="closeClientDetails()">
    <div class="modal-content modal-large" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>DÃ©tails du Client</h2>
        <button class="btn-close" (click)="closeClientDetails()">âœ•</button>
      </div>

      <div class="modal-body">
        <div class="client-details-full">
          <div class="detail-section">
            <h3>ðŸ“‹ Informations Personnelles</h3>
            <div class="detail-grid">
              <div class="detail-row">
                <span class="label">Nom:</span>
                <span class="value">{{ selectedClient.name }}</span>
              </div>
              <div class="detail-row">
                <span class="label">Email:</span>
                <span class="value">{{ selectedClient.email }}</span>
              </div>
              <div class="detail-row" *ngIf="selectedClient.age">
                <span class="label">Ã‚ge:</span>
                <span class="value">{{ selectedClient.age }} ans</span>
              </div>
              <div class="detail-row" *ngIf="selectedClient.phone">
                <span class="label">TÃ©lÃ©phone:</span>
                <span class="value">{{ selectedClient.phone }}</span>
              </div>
            </div>
          </div>

          <div class="detail-section">
            <h3>ðŸ“Š Statistiques</h3>
            <div class="detail-grid">
              <div class="detail-row">
                <span class="label">Date d'assignation:</span>
                <span class="value">{{ selectedClient.assignedDate | date:'dd/MM/yyyy' }}</span>
              </div>
              <div class="detail-row">
                <span class="label">DerniÃ¨re activitÃ©:</span>
                <span class="value">{{ formatLastActivity(selectedClient.lastActivity) }}</span>
              </div>
              <div class="detail-row">
                <span class="label">Programmes actifs:</span>
                <span class="value">{{ selectedClient.programsCount }}</span>
              </div>
              <div class="detail-row">
                <span class="label">Taux de progrÃ¨s:</span>
                <span class="value" [ngClass]="selectedClient.progressClass">
                  {{ selectedClient.progressRate }}%
                </span>
              </div>
              <div class="detail-row" *ngIf="selectedClient.isInactive">
                <span class="label">Statut:</span>
                <span class="value inactive-warning">
                  <i class="pi pi-exclamation-triangle"></i>
                  Client inactif depuis plus de 7 jours
                </span>
              </div>
            </div>
          </div>

          <div class="detail-actions">
            <button class="btn-primary">Voir les programmes</button>
            <button class="btn-primary">GÃ©nÃ©rer un rapport</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
